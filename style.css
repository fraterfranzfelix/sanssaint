/* =============================================================================
   STYLESHEET INDEX
   1. Variables & Setup
   2. Layout, Scrolling & Snap
   3. Header
   4. Hero Section
      4a. Parallax Layers
      4b. Particle Animations
      4c. Center Container
      4d. Buttons
      4e. Hero Footer
      4f. Weapons Layers
   5. Section 2: Split Panels
      5a. Panel Configuration
      5b. Background Images
      5c. Gradient Overlays
      5d. Rule of Thirds Grid
      5e. Typography
      5f. Center Image (Angel)
   6. Responsive Breakpoints
============================================================================= */


/* =============================================================================
   1. VARIABLES & SETUP
============================================================================= */

:root {
    --viola-violet: #785adc;
    --malve-magenta: #fa8ca0;
    --blanc-leger: #eaeaea;
    --noir-leger: #151515;
    --font-primary: 'EB Garamond', serif;

    /* Em dash stroke weight — set precisely by JS canvas measurement after font load.
       This fallback value is intentionally approximate and will be overridden at runtime. */
    --em-dash-weight: 0.09rem;
}

@font-face {
    font-family: 'EB Garamond';
    src: url('assets/eb_garamond/EBGaramond-VariableFont_wght.ttf') format('truetype');
    font-weight: 400 800;
    font-style: normal;
}

* {
    box-sizing: border-box;
    margin: 0;
    padding: 0;
}

body {
    font-family: var(--font-primary);
    color: var(--noir-leger);
    background-color: var(--blanc-leger);
    overflow: hidden;
}


/* =============================================================================
   2. LAYOUT, SCROLLING & SNAP
============================================================================= */

/* Sections snap to full-viewport increments for a curated slide experience.
   smooth scroll-behavior animates the snap jump rather than cutting instantly. */
.scroll-container {
    height: 100vh;
    width: 100vw;
    overflow-y: scroll;
    scroll-behavior: smooth;
    scroll-snap-type: y mandatory;
}

.section {
    position: relative;
    height: 100vh;
    width: 100%;
    scroll-snap-align: start;
    display: flex;
    justify-content: center;
    align-items: center;
}


/* =============================================================================
   3. HEADER
============================================================================= */

/* The header floats above all sections as a fixed overlay with no background.
   mix-blend-mode: difference inverts content color against whatever is behind:
   white content reads as near-white on dark backgrounds, near-black on light.

   Structure: three equal flex columns — [left nav + line] [wordmark] [line + controls].
   The two line halves are split SVGs of the same em dash path, each stretching
   with preserveAspectRatio="none" to fill their column's remaining space while
   keeping the serif caps at the outer edges undistorted.

   When the wordmark is hidden (section 1), its center column collapses to
   max-width: 0, and the two line halves grow to meet seamlessly in the middle.
   When the wordmark appears, the column expands and the lines split apart.

   IMPORTANT: All child images use filter: brightness(0) invert(1) to force
   pure white output, which mix-blend-mode: difference requires to invert correctly.
   This works regardless of the original asset color — no re-export needed. */
.site-header {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 3rem;
    padding: 1rem 3rem;
    z-index: 100;

    display: flex;
    align-items: center;

    mix-blend-mode: difference;
    color: white;

    transition: padding 0.3s ease;
}


/* --- Outer columns -------------------------------------------------------- */

/* Both outer columns are equal-flex so the center wordmark sits at exactly 50% */
.header-col {
    flex: 1;
    display: flex;
    align-items: center;
    min-width: 0;       /* Prevents flex children from overflowing */
}

.header-col-left {
    gap: 3rem;          /* Space between nav items and the left line half */
}

.header-col-right {
    gap: 3rem;          /* Space between the right line half and controls */
    justify-content: flex-end;
}


/* --- Nav links ------------------------------------------------------------ */

.header-nav {
    display: flex;
    align-items: center;
    gap: 3rem;
    list-style: none;
    flex-shrink: 0;     /* Nav never shrinks — the line absorbs available space */
}

.header-nav a {
    font-family: var(--font-primary);
    font-size: 1rem;
    font-weight: 400;
    color: white;
    text-decoration: none;
    letter-spacing: 0.03em;
    transition: font-weight 0.2s ease;
}

.header-nav a:hover {
    font-weight: 600;
    letter-spacing: 0.04em;
}


/* --- Em dash line halves -------------------------------------------------- */

/* Each line is a three-part flex row: [cap-left] [body] [cap-right].
   This gives every half-line its own complete pair of serif caps.
   
   The path's viewBox (0 0 73.05 8.4) is sliced into three non-overlapping zones:
     Left cap:  x=0   → x=5     — the left serif, shown at natural proportions
     Body:      x=4   → x=69.05 — the straight rectangular middle, allowed to stretch
     Right cap: x=68  → x=73.05 — the right serif, shown at natural proportions
   
   The slight overlaps (4–5 on the left seam, 68–69.05 on the right) prevent
   any hairline gap artifact between segments.
   
   Height for all three parts is driven by --em-dash-weight, which JS sets
   precisely from a canvas measurement of the actual rendered font glyph. */
.header-line {
    flex: 1;
    display: flex;
    align-items: center;
    min-width: 0;
}

/* Left serif cap — fixed proportions, never stretched */
.line-cap-left {
    height: var(--em-dash-weight);
    aspect-ratio: 5 / 8.4;   /* matches viewBox "0 0 5 8.4" */
    flex-shrink: 0;
    display: block;
    overflow: visible;
}

/* Right serif cap — fixed proportions, never stretched */
.line-cap-right {
    height: var(--em-dash-weight);
    aspect-ratio: 5.05 / 8.4;  /* matches viewBox "68 0 5.05 8.4" */
    flex-shrink: 0;
    display: block;
    overflow: visible;
}

/* Body — pure rectangular section, stretched horizontally to fill remaining space */
.line-body {
    flex: 1;
    height: var(--em-dash-weight);
    display: block;
    min-width: 0;
}


/* --- Center column: wordmark ---------------------------------------------- */

/* Starts collapsed (max-width: 0, padding: 0) so the two line halves touch.
   JS adds .is-visible once the hero wholemark scrolls up to meet the header,
   creating the illusion that the logo snaps from center-screen into the header.
   Both max-width and padding are transitioned so the gap opens smoothly.
   box-sizing: border-box (global) means max-width constrains the total box
   including padding — both collapse together to zero. */
.header-center {
    overflow: hidden;
    flex-shrink: 0;
    max-width: 0;
    padding: 0;
    display: flex;
    align-items: center;
    transition: max-width 0.45s ease, padding 0.45s ease;
}

.header-center.is-visible {
    max-width: 16rem;   /* Generous upper bound: wordmark width + 2 × 1.5rem padding */
    padding: 0 1.5rem;  /* Gap between each line end and the wordmark edges */
}

.header-wordmark {
    height: 1rem;
    width: auto;
    display: block;
    flex-shrink: 0;
    filter: brightness(0) invert(1);

    /* Fades in slightly after the gap begins to open */
    opacity: 0;
    transition: opacity 0.3s ease 0.15s;
}

.header-center.is-visible .header-wordmark {
    opacity: 1;
}


/* --- Right controls ------------------------------------------------------- */

.header-controls {
    display: flex;
    align-items: center;
    gap: 3rem;
    flex-shrink: 0;
}

/* Mute toggle button */
.header-mute {
    background: none;
    border: none;
    padding: 0;
    cursor: pointer;
    display: flex;
    align-items: center;
}

.header-mute img {
    height: 1rem;
    width: auto;
    filter: brightness(0) invert(1);
}

/* Language dropdown */
.header-lang {
    position: relative;
}

.header-lang-toggle {
    font-family: var(--font-primary);
    font-size: 1rem;
    font-weight: 500;
    color: white;
    background: none;
    border: none;
    padding: 0;
    cursor: pointer;
    letter-spacing: 0.02em;
    display: flex;
    align-items: center;
    gap: 0.35rem;
    transition: font-weight 0.2s ease;
}

.header-lang-toggle:hover {
    font-weight: 700;
}

.header-lang-toggle::after {
    content: '▾';
    font-size: 0.7rem;
}

.header-lang-dropdown {
    position: absolute;
    top: calc(100% + 0.75rem);
    right: 0;
    display: none;
    flex-direction: column;
    gap: 0.5rem;
    list-style: none;
}

.header-lang-dropdown.is-open {
    display: flex;
}

.header-lang-dropdown a {
    font-family: var(--font-primary);
    font-size: 1rem;
    font-weight: 500;
    color: white;
    text-decoration: none;
    white-space: nowrap;
    letter-spacing: 0.02em;
    transition: font-weight 0.2s ease;
}

.header-lang-dropdown a:hover {
    font-weight: 700;
}


/* --- Responsive: tighter padding below 960px ------------------------------ */

@media (max-width: 960px) {
    .site-header {
        padding: 1rem 2rem;
    }

    .header-col-left,
    .header-col-right {
        gap: 2rem;
    }

    .header-nav {
        gap: 2rem;
    }

    .header-controls {
        gap: 2rem;
    }
}

/* --- Mobile (≤ 768px): header collapse placeholder ------------------------ */
/* Full mobile dropdown menu to be implemented alongside the loading screen. */


/* =============================================================================
   4. HERO SECTION
============================================================================= */

.hero-section {
    position: relative;
    overflow: hidden;
}


/* --- 3a. Parallax Layers -------------------------------------------------- */

/* All moving layers share these base rules.
   Sized at 110% to prevent edge gaps during movement. */
.parallax-layer {
    position: absolute;
    top: -5%;
    left: -5%;
    width: 110%;
    height: 110%;
    pointer-events: none;
}

/* Background painting — lowest z-index */
.bg-layer {
    z-index: 1;
    background-image: -webkit-image-set(
        url('assets/01_caspar_david_friedrich_abtei_im_eichwald.avif') 1x,
        url('assets/01_caspar_david_friedrich_abtei_im_eichwald.jpeg') 1x
    );
    background-image: image-set(
        url('assets/01_caspar_david_friedrich_abtei_im_eichwald.avif') type('image/avif'),
        url('assets/01_caspar_david_friedrich_abtei_im_eichwald.jpeg') type('image/jpeg')
    );
    background-size: cover;
    background-position: center;
}

/* Ensures hero content sits between the back and front particle layers */
.relative-content {
    position: relative;
    z-index: 10;
}


/* --- 3b. Particle Animations ---------------------------------------------- */

/* Smaller, blurred dots — drift slowly */
.particles-back {
    z-index: 5;
    background-image: radial-gradient(var(--blanc-leger) 1px, transparent 2px),
                      radial-gradient(var(--blanc-leger) 1px, transparent 2px);
    background-size: 200px 200px, 300px 300px;
    background-position: 0 0, 40px 60px;
    opacity: 1;
    filter: blur(1px);
    animation: wind-back 33s linear infinite;
}

/* Larger, sharper dots — drift faster */
.particles-front {
    z-index: 20;
    background-image: radial-gradient(var(--blanc-leger) 3px, transparent 4px),
                      radial-gradient(var(--blanc-leger) 2px, transparent 3px);
    background-size: 500px 500px, 400px 400px;
    background-position: 0 0, 60px 90px;
    opacity: 1;
    filter: blur(0.5px);
    animation: wind-front 12s linear infinite;
}

/* Gentle drift with a slight rightward curve */
@keyframes wind-back {
    0%   { background-position: 0 0, 40px 60px; }
    50%  { background-position: 20px 500px, 60px 560px; }
    100% { background-position: 50px 1000px, 90px 1060px; }
}

/* Stronger gust with variable speed mid-flight */
@keyframes wind-front {
    0%   { background-position: 0 0, 60px 90px; }
    25%  { background-position: 50px 250px, 110px 340px; }
    75%  { background-position: 120px 750px, 180px 840px; }
    100% { background-position: 200px 1000px, 260px 1090px; }
}


/* --- 3c. Center Container ------------------------------------------------- */

/* Width glides from 33.33% on wide screens to 50% at 960px,
   eliminating the discrete 960px breakpoint entirely. */
.center-container {
    width: clamp(33.33%, calc(33.33% + (1400px - 100vw) * 0.037886), 50%);
    display: flex;
    flex-direction: column;
    align-items: center;
    text-align: center;
    padding: 2rem;
    transition: width 0.4s ease;
}

.hero-logo {
    width: 100%;
    margin-bottom: 2rem;
    height: auto;
}


/* --- 3d. Buttons ---------------------------------------------------------- */

.button-wrapper {
    display: flex;
    flex-wrap: wrap;
    gap: 0.5rem;
    width: 100%;
}

.btn {
    flex: 1 0 150px;
    display: flex;
    justify-content: center;
    align-items: center;
    padding: 0.25rem 2rem;
    font-family: var(--font-primary);
    font-size: 1rem;
    font-weight: 500;
    letter-spacing: 0.02em;
    text-decoration: none;
    cursor: pointer;
    border: none;
    border-radius: 1rem;
    outline: none;
    transition: all 0.3s ease;
}

.btn:hover {
    font-weight: 600;
    letter-spacing: 0.025em;
}

/* Light neumorphic button */
.btn-white {
    background-color: var(--blanc-leger);
    color: var(--noir-leger);
    box-shadow:
        -4px -4px 10px rgba(255,255,255, 0.8),
         4px  4px 10px rgba(0,0,0, 0.1);
}

.btn-white:hover {
    transform: translateY(-2px);
    box-shadow:
        -6px -6px 14px rgba(255,255,255, 0.9),
         6px  6px 14px rgba(0,0,0, 0.15);
}

/* Dark neumorphic button */
.btn-black {
    background-color: var(--noir-leger);
    color: var(--blanc-leger);
    box-shadow:
        -4px -4px 10px rgba(255,255,255, 0.05),
         4px  4px 10px rgba(0,0,0, 0.3);
}

.btn-black:hover {
    transform: translateY(-2px);
    box-shadow:
        -6px -6px 14px rgba(255,255,255, 0.08),
         6px  6px 14px rgba(0,0,0, 0.4);
}


/* --- 3e. Hero Footer ------------------------------------------------------ */

.hero-footer {
    position: absolute;
    bottom: 2rem;
    left: 0;
    width: 100%;
    text-align: center;
    font-family: var(--font-primary);
    font-size: 0.67rem;
    font-weight: 500;
    color: var(--noir-leger);
    z-index: 10;
}

.hero-footer p {
    margin: 0;
}


/* --- 3f. Weapons Layers --------------------------------------------------- */

/* Primary strategy — position absorbs viewport changes, not size:
     Width is locked at 700px (= exactly 50vw at the 1400px design baseline).
     On wider screens it scales up proportionally as 50vw so the swords always
     meet at the center with zero gap and zero overlap.
     As the viewport narrows below 1400px, the image stays 700px wide; only the
     outer edges slide off-screen (up to −12.5%) while the inner edges naturally
     begin to overlap (up to ~30%). No resizing happens at all in this range.

   Secondary strategy — only below 900px, where primary is exhausted:
     Height and width start stepping down. Both properties are transitioned
     so the reduction feels like a breath rather than a jump. */
.weapons-layer {
    top: auto;
    bottom: 0;
    height: 110%;
    width: max(50vw, 700px);
    z-index: 7;
    transition: width 0.4s ease, height 0.4s ease;
}

.weapons-layer picture,
.weapons-layer img {
    width: 100%;
    height: 100%;
    display: block;
    object-fit: contain;
}

/* Outer edges glide off-screen from 0 (at 1400px) to −12.5% (at 900px).
   The formula resolves to 0 on wide screens and is clamped at −12.5% below 900px.
   Combined with the 75% mobile width cap, this allows up to ~50% image overlap
   at the narrowest sizes before the secondary height-reduction strategy takes over. */
.weapons-left {
    left: clamp(-12.5%, calc((100vw - 1400px) * 0.225), 0%);
}

.weapons-left img {
    object-position: left bottom;
}

.weapons-right {
    left: auto;
    right: clamp(-12.5%, calc((100vw - 1400px) * 0.225), 0%);
}

.weapons-right img {
    object-position: right bottom;
}


/* =============================================================================
   4. SECTION 2: SPLIT PANELS
============================================================================= */

.split-section {
    display: flex;
    flex-direction: row;
    width: 100vw;
    height: 100vh;
    overflow: hidden;
    position: relative;
}

.panel {
    position: relative;
    height: 100%;
    overflow: hidden;
}


/* --- 4a. Panel Configuration ---------------------------------------------- */

/* Left panel extends 20px beyond 50% so it tucks cleanly behind the right panel */
.panel-left {
    flex: 0 0 calc(50% + 20px);
    max-width: calc(50% + 20px);
    margin-right: -20px;
    z-index: 1;
}

/* Right panel sits on top with a rounded top-left corner */
.panel-right {
    flex: 0 0 50%;
    max-width: 50%;
    z-index: 2;
    border-top-left-radius: 20px;
    -webkit-mask-image: -webkit-radial-gradient(white, black);
    mask-image: radial-gradient(white, black);
    overflow: hidden;
}


/* --- 4b. Background Images ------------------------------------------------ */

/* Both layers are oversized to allow parallax movement without edge gaps */
.bg-layer-creation {
    width: 115% !important;
    height: 115% !important;
    left: -7.5% !important;
    top: -7.5% !important;
    background-image: -webkit-image-set(url('assets/03_gustave_dore_creation.jpeg') 1x);
    background-image: image-set(
        url('assets/03_gustave_dore_creation.avif') type('image/avif'),
        url('assets/03_gustave_dore_creation.jpeg') type('image/jpeg')
    );
    background-size: cover;
    background-position: center;
}

.bg-layer-eden {
    width: 115% !important;
    height: 115% !important;
    left: -7.5% !important;
    top: -7.5% !important;
    background-image: -webkit-image-set(url('assets/04_gustave_dore_jacobs_dream.jpeg') 1x);
    background-image: image-set(
        url('assets/04_gustave_dore_jacobs_dream.avif') type('image/avif'),
        url('assets/04_gustave_dore_jacobs_dream.jpeg') type('image/jpeg')
    );
    background-size: cover;
    background-position: center;
}


/* --- 4c. Gradient Overlays ------------------------------------------------ */

/* Fade edges of the left panel into the page background color */
.gradient-overlay {
    position: absolute;
    left: 0;
    width: 100%;
    height: 2rem;
    z-index: 5;
    pointer-events: none;
}

.gradient-top {
    top: 0;
    background: linear-gradient(to bottom, var(--blanc-leger), transparent);
}

.gradient-bottom {
    bottom: 0;
    background: linear-gradient(to top, var(--blanc-leger), transparent);
}


/* --- 4d. Rule of Thirds Grid ---------------------------------------------- */

/* Three equal columns keep text anchored to the middle third of each panel.
   Column ratio is transitioned so grid tightening at breakpoints feels gradual. */
.thirds-grid {
    position: relative;
    z-index: 10;
    width: 100%;
    height: 100%;
    display: grid;
    grid-template-columns: 1fr 1fr 1fr;
    grid-template-rows: 1fr auto 1fr;
    align-items: center;
    transition: grid-template-columns 0.4s ease;
}

.grid-center-content {
    grid-column: 2;
    grid-row: 2;
    justify-self: center;
    width: 100%;
    white-space: nowrap;
    font-family: var(--font-primary);
    font-size: 1rem;
    font-weight: 500;
    line-height: 1.5;
}


/* --- 4e. Typography ------------------------------------------------------- */

/* Alignment utilities */
.text-left  { text-align: left; }
.align-right { text-align: right; }

/* Color utilities */
.text-noir  { color: var(--noir-leger); }
.text-blanc { color: var(--blanc-leger); }

/* Branded highlights */
.highlight-viola {
    color: var(--viola-violet);
    font-weight: 800;
    font-variant: small-caps;
}

.highlight-malve {
    color: var(--malve-magenta);
    font-weight: 800;
    font-variant: small-caps;
}

.citation {
    font-size: 0.67rem;
    display: inline-block;
    opacity: 0.9;
}


/* --- 4f. Center Image (Angel) --------------------------------------------- */

/* Absolutely centered within the split section, hovering above both panels.
   JS parallax composes its translate on top of the base -50%/-50% centering.
   Height is transitioned so breakpoint resizes feel smooth. Transform is
   intentionally excluded from the transition to keep JS parallax responsive. */
.center-image-wrapper {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    height: 85.71%;
    z-index: 15;
    pointer-events: none;
    transition: height 0.4s ease;
}

.center-angel-img {
    height: 100%;
    width: auto;
    object-fit: contain;
    /* Neumorphic-style shadow: soft light from top-left, soft dark from bottom-right */
    filter:
        drop-shadow( 4px  4px 12px rgba(0, 0, 0, 0.12));
}


/* =============================================================================
   5. RESPONSIVE BREAKPOINTS

   clamp() handles the continuous fluid range for weapons bleed and several
   widths, so hard breakpoints are kept to a minimum. What remains:
     — Two grid-ratio steps for the split panel text (1300px, 1000px)
     — One secondary-strategy step for weapons height (900px)
     — One full layout flip for mobile (768px)
   Every discrete property change is transitioned so threshold crossings
   feel like gentle animations rather than snaps.
============================================================================= */

/* (≤ 1300px) Grid tightens — side padding narrows from 33% to 25% */
@media (max-width: 1300px) {
    .thirds-grid          { grid-template-columns: 1fr 2fr 1fr; }
    .center-image-wrapper { height: 70%; }
}

/* (≤ 1000px) Grid tightens further — side padding narrows to ~16.6% */
@media (max-width: 1000px) {
    .thirds-grid          { grid-template-columns: 1fr 4fr 1fr; }
    .center-image-wrapper { height: 58%; }
}

/* (≤ 900px) Secondary strategy begins — primary bleed/overlap is exhausted.
   Height steps down; width will follow only if absolutely necessary. */
@media (max-width: 900px) {
    .weapons-layer { height: 95%; }
}

/* (≤ 768px) Full mobile stack — the one intentional hard layout change */
@media (max-width: 768px) {
    .center-container { width: 66.66%; }

    .split-section { flex-direction: column; }

    .panel {
        width: 100%;
        height: 50vh;
        flex: auto;
        max-width: 100%;
        margin: 0;
        border-radius: 0;
    }

    /* Full panel width restores the spacious 1/3 grid margins */
    .thirds-grid { grid-template-columns: 1fr 1fr 1fr; }

    /* Angel shifts left so only ~45% is visible by default — enough to feel
       present without blocking text. Parallax (tilt or cursor) reveals the rest. */
    .center-image-wrapper {
        left: 0;
        height: 65%;
        transform: translate(-55%, -50%);
    }

    /* Weapons yield to percentage sizing on narrow mobile viewports.
       75% width allows up to ~50% overlap between the two images. */
    .weapons-layer { width: 75%; height: 80%; }
}